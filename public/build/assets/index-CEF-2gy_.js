import{I as u}from"./index-BOAzHGzj.js";function g(){const e=document.getElementById("login-form"),t=document.getElementById("cad-form"),n=document.getElementById("titulo-area"),o=document.getElementById("link-cadastro"),s=document.getElementById("link-login");o&&s&&e&&t&&n?(o.addEventListener("click",a=>{a.preventDefault(),e.classList.add("hidden"),t.classList.remove("hidden"),n.innerHTML="Área de Cadastro Cliente"}),s.addEventListener("click",a=>{a.preventDefault(),e.classList.remove("hidden"),t.classList.add("hidden"),n.innerHTML="Área de Login"})):console.warn("Elementos do login/cadastro não encontrados.")}function m(e,t){e.addEventListener("input",n),t.addEventListener("input",n);function n(){t.value===e.value&&t.value!==""?(t.classList.remove("border-red-500","focus:ring-red-500"),e.classList.remove("border-red-500","focus:ring-red-500"),t.classList.add("border-green-500","focus:ring-green-500"),e.classList.add("border-green-500","focus:ring-green-500")):(t.classList.remove("border-green-500","focus:ring-green-500"),e.classList.remove("border-green-500","focus:ring-green-500"),t.classList.add("border-red-500","focus:ring-red-500"),e.classList.add("border-red-500","focus:ring-red-500"))}}function f(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function h(e){const t=/\d/.test(e),n=e.length>=6;return t&&n}function v(){const e=document.getElementById("email-cad"),t=document.getElementById("erro-email"),n=document.getElementById("senha-cad"),o=document.getElementById("erro-senha");e.addEventListener("input",()=>{f(e.value)?(t.classList.add("hidden"),e.classList.remove("border-red-500"),e.classList.add("border-green-500")):(t.classList.remove("hidden"),e.classList.add("border-red-500"),e.classList.remove("border-green-500"))}),n.addEventListener("input",()=>{h(n.value)?(o.classList.add("hidden"),n.classList.remove("border-red-500"),n.classList.add("border-green-500")):(o.classList.remove("hidden"),n.classList.add("border-red-500"),n.classList.remove("border-green-500"))})}function L(e="telefone"){const t=document.getElementById(e);u(t,{mask:[{mask:"(00) 0000-0000",lazy:!1},{mask:"(00) 00000-0000",lazy:!1}]})}async function E(e){const t="administrador",n="barbeiro",o="cliente";e.addEventListener("submit",async function(s){s.preventDefault();const a=document.getElementById("email").value,i=document.getElementById("senha").value;try{const r=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:a,senha:i})}),d=await r.json();if(!r.ok){alert(d.erro||"Email ou senha inválidos");return}switch(localStorage.setItem("token",d.token),(await(await fetch("/api/me",{headers:{Authorization:`Bearer ${d.token}`}})).json()).tipo_usuario){case t:window.location.href="/hubadmin";break;case n:window.location.href="/hubbarbeiro";break;case o:window.location.href="/hubcliente";break;default:alert("Tipo de usuário desconhecido")}}catch(r){console.error(r),alert("Erro na comunicação")}})}async function y(e){const t="cliente";e.addEventListener("submit",async function(n){var r,d;n.preventDefault();const o=document.getElementById("nome").value,s=document.getElementById("telefone").value,a=document.getElementById("email-cad").value,i=document.getElementById("senha-cad").value;try{const c=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({nome:o,telefone:s,email:a,senha:i,tipo_usuario:t})}),l=await c.json();if(!c.ok){alert(l.erro||"Credenciais inválidas");return}alert("Conta cadastrada com sucesso!"),(r=document.getElementById("cad-form"))==null||r.classList.add("hidden"),(d=document.getElementById("login-form"))==null||d.classList.remove("hidden")}catch(c){console.error(c),alert("Erro no cadastro. Verifique novamente!")}})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("email-cad"),t=document.getElementById("email-confirm"),n=document.getElementById("senha-cad"),o=document.getElementById("senha-confirm");g(),m(e,t),m(n,o),v();const s=document.getElementById("form-login");s&&E(s);const a=document.getElementById("form-cadastro");a&&y(a),L()});
